{
  "index_patterns": ["cowrie.reports.daily-*"]
,
  "template": {
    "settings": {
      "number_of_shards": 1,
      "number_of_replicas": 0,
      "index": {
        "lifecycle": {
          "name": "cowrie.reports.daily",
          "rollover_alias": "cowrie.reports.daily-write"
        },
        "refresh_interval": "30s"
      }
    },
    "mappings": {
      "numeric_detection": true,
      "_meta": {
        "beat": "cowrie.reports"
      },
      "dynamic_templates": [
        {
          "strings_as_keyword": {
            "match_mapping_type": "string",
            "mapping": {
              "ignore_above": 1024,
              "type": "keyword"
            }
          }
        }
      ],
      "properties": {
        "@timestamp": {"type": "date"},
        "date_utc": {"type": "date"},
        "year_week": {"type": "keyword"},
        "year_month": {"type": "keyword"},
        "date_range": {
          "properties": {"start": {"type": "date"}, "end": {"type": "date"}}
        },
        "sensor": {"type": "keyword"},
        "generated_at": {"type": "date"},
        "report_type": {"type": "keyword"},
        "days_included": {"type": "integer"},
        "sessions": {
          "properties": {
            "total": {"type": "long"},
            "unique_ips": {"type": "long"},
            "unique_usernames": {"type": "long"},
            "unique_passwords": {"type": "long"},
            "avg_commands": {"type": "float"},
            "max_commands": {"type": "long"},
            "min_commands": {"type": "long"},
            "avg_duration": {"type": "float"},
            "daily_average": {"type": "float"},
            "protocols": {"type": "object"},
            "top_usernames": {"type": "nested", "properties": {"value": {"type": "keyword"}, "count": {"type": "long"}}},
            "top_passwords": {"type": "nested", "properties": {"value": {"type": "keyword"}, "count": {"type": "long"}}},
            "top_combinations": {"type": "nested", "properties": {"value": {"type": "keyword"}, "count": {"type": "long"}}}
          }
        },
        "commands": {
          "properties": {
            "total": {"type": "long"},
            "unique": {"type": "long"},
            "daily_average": {"type": "float"},
            "top_commands": {
              "type": "nested",
              "properties": {
                "value": {"type": "keyword", "fields": {"text": {"type": "match_only_text"}}},
                "count": {"type": "long"}
              }
            }
          }
        },
        "files": {
          "properties": {
            "downloads_total": {"type": "long"},
            "uploads_total": {"type": "long"},
            "unique_hashes": {"type": "long"},
            "unique_vt_classifications": {"type": "long"},
            "recent_vt_submissions": {"type": "long"},
            "vt_classifications_top": {"type": "nested", "properties": {"value": {"type": "keyword"}, "count": {"type": "long"}}},
            "top_hashes": {"type": "nested", "properties": {"value": {"type": "keyword"}, "count": {"type": "long"}}}
          }
        },
        "enrichments": {
          "properties": {
            "urlhaus_tags_top": {"type": "nested", "properties": {"value": {"type": "keyword"}, "count": {"type": "long"}}},
            "asn_top": {"type": "nested", "properties": {"value": {"type": "keyword"}, "count": {"type": "long"}}},
            "country_top": {"type": "nested", "properties": {"value": {"type": "keyword"}, "count": {"type": "long"}}},
            "spur_infrastructure_top": {"type": "nested", "properties": {"value": {"type": "keyword"}, "count": {"type": "long"}}},
            "spur_tunnels": {"properties": {"total": {"type": "long"}, "anonymous": {"type": "long"}}}
          }
        },
        "abnormalities": {
          "properties": {
            "uncommon_command_sessions": {"type": "long"},
            "recent_vt_submission_sessions": {"type": "long"}
          }
        },
        "alerts": {
          "type": "nested",
          "properties": {
            "type": {"type": "keyword"},
            "severity": {"type": "keyword"},
            "message": {"type": "text", "fields": {"keyword": {"type": "keyword", "ignore_above": 256}}},
            "current": {"type": "float"},
            "average": {"type": "float"},
            "percentage": {"type": "float"},
            "classifications": {"type": "keyword"}
          }
        },
        "alerts_summary": {
          "type": "nested",
          "properties": {"type": {"type": "keyword"}, "severity": {"type": "keyword"}, "message": {"type": "text"}}
        }
      }
    }
  }
}
}
