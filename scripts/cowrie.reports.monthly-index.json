{
  "index_patterns": ["cowrie.reports.monthly-*"]
,
  "template": {
    "settings": {
      "number_of_shards": 1,
      "number_of_replicas": 0,
      "index": {
        "lifecycle": {
          "name": "cowrie.reports.monthly",
          "rollover_alias": "cowrie.reports.monthly-write"
        },
        "refresh_interval": "30s"
      }
    },
    "mappings": {
      "numeric_detection": true,
      "_meta": {"beat": "cowrie.reports"},
      "dynamic_templates": [
        {"strings_as_keyword": {"match_mapping_type": "string", "mapping": {"ignore_above": 1024, "type": "keyword"}}}
      ],
      "properties": {
        "@timestamp": {"type": "date"},
        "year_month": {"type": "keyword"},
        "date_range": {"properties": {"start": {"type": "date"}, "end": {"type": "date"}}},
        "sensor": {"type": "keyword"},
        "report_type": {"type": "keyword"},
        "generated_at": {"type": "date"},
        "days_included": {"type": "integer"},
        "sessions": {"properties": {"total": {"type": "long"}, "unique_ips": {"type": "long"}, "daily_average": {"type": "float"}}},
        "commands": {"properties": {"total": {"type": "long"}, "daily_average": {"type": "float"}}},
        "files": {"properties": {"downloads_total": {"type": "long"}, "uploads_total": {"type": "long"}, "daily_average_downloads": {"type": "float"}}},
        "enrichments": {"properties": {"unique_vt_classifications": {"type": "integer"}, "unique_urlhaus_tags": {"type": "integer"}, "unique_countries": {"type": "integer"}, "unique_asns": {"type": "integer"}}},
        "alerts_summary": {"type": "object"},
        "trends": {"properties": {"sessions_change": {"type": "float"}, "unique_ips_change": {"type": "float"}, "files_change": {"type": "float"}}}
      }
    }
  }
}

